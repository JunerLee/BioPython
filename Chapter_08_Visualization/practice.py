#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Chapter 08: æ•°æ®å¯è§†åŒ– - ç»ƒä¹ é¢˜

é€šè¿‡å®é™…ç»ƒä¹ æŒæ¡ä»åŸºç¡€åˆ°å‘è¡¨çº§åˆ«çš„ç§‘ç ”å›¾è¡¨åˆ¶ä½œã€‚

éš¾åº¦åˆ†çº§ï¼š
â˜…     åŸºç¡€ï¼šæŒæ¡åŸºæœ¬ç»˜å›¾æŠ€èƒ½
â˜…â˜…    è¿›é˜¶ï¼šåˆ¶ä½œä¸“ä¸šçš„ç§‘ç ”å›¾è¡¨
â˜…â˜…â˜…   æŒ‘æˆ˜ï¼šåˆ›å»ºå‘è¡¨çº§åˆ«çš„ç»„åˆå›¾è¡¨
"""

import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np
import pandas as pd
from scipy import stats


def practice_1_basic_scatter():
    """
    ç»ƒä¹ 1ï¼ˆâ˜…ï¼‰ï¼šç»˜åˆ¶åŸºå› è¡¨è¾¾æ•£ç‚¹å›¾
    
    ä»»åŠ¡ï¼š
    1. åˆ›å»ºä¸¤ç»„åŸºå› è¡¨è¾¾æ•°æ®ï¼ˆå¯¹ç…§ç»„ vs å¤„ç†ç»„ï¼‰
    2. ç»˜åˆ¶æ•£ç‚¹å›¾
    3. æ·»åŠ å›å½’çº¿å’Œç›¸å…³ç³»æ•°
    4. ä½¿ç”¨è‰²ç›²å‹å¥½çš„é…è‰²
    
    ç”Ÿç‰©å­¦èƒŒæ™¯ï¼š
    æ¯”è¾ƒä¸¤ä¸ªæ¡ä»¶ä¸‹çš„åŸºå› è¡¨è¾¾ï¼Œæ‰¾å‡ºè¡¨è¾¾æ¨¡å¼çš„ç›¸å…³æ€§ã€‚
    """
    print("ç»ƒä¹ 1ï¼ˆâ˜…ï¼‰ï¼šåŸºå› è¡¨è¾¾æ•£ç‚¹å›¾")
    print("-" * 40)
    
    # TODO: ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®
    # æç¤ºï¼šä½¿ç”¨ np.random.normal() åˆ›å»ºä¸¤ç»„ç›¸å…³çš„æ•°æ®
    # control = ?
    # treatment = ?
    
    # TODO: åˆ›å»ºæ•£ç‚¹å›¾
    # æç¤ºï¼šä½¿ç”¨ plt.scatter()ï¼Œæ³¨æ„è®¾ç½® alpha é€æ˜åº¦
    
    # TODO: è®¡ç®—ç›¸å…³ç³»æ•°
    # æç¤ºï¼šä½¿ç”¨ scipy.stats.pearsonr()
    
    # TODO: æ·»åŠ å›å½’çº¿
    # æç¤ºï¼šä½¿ç”¨ np.polyfit() å’Œ np.poly1d()
    
    # TODO: æ·»åŠ å›¾ä¾‹å’Œæ ‡ç­¾
    # æç¤ºï¼šxlabel, ylabel, title, legend
    
    pass


def practice_2_boxplot_with_significance():
    """
    ç»ƒä¹ 2ï¼ˆâ˜…ï¼‰ï¼šå¤šç»„æ•°æ®ç®±çº¿å›¾ä¸æ˜¾è‘—æ€§æ ‡è®°
    
    ä»»åŠ¡ï¼š
    1. åˆ›å»ºä¸‰ç»„åŸºå› è¡¨è¾¾æ•°æ®ï¼ˆä¸åŒå¤„ç†æ¡ä»¶ï¼‰
    2. ç»˜åˆ¶ç®±çº¿å›¾ï¼Œæ˜¾ç¤ºä¸­ä½æ•°ã€å››åˆ†ä½æ•°å’Œå¼‚å¸¸å€¼
    3. è¿›è¡Œç»Ÿè®¡æ£€éªŒå¹¶æ ‡è®°æ˜¾è‘—æ€§
    4. ä½¿ç”¨ä¸“ä¸šçš„é…è‰²æ–¹æ¡ˆ
    
    ç”Ÿç‰©å­¦èƒŒæ™¯ï¼š
    æ¯”è¾ƒä¸åŒè¯ç‰©å¤„ç†å¯¹åŸºå› è¡¨è¾¾çš„å½±å“ã€‚
    """
    print("\nç»ƒä¹ 2ï¼ˆâ˜…ï¼‰ï¼šç®±çº¿å›¾ä¸æ˜¾è‘—æ€§æ ‡è®°")
    print("-" * 40)
    
    # TODO: åˆ›å»ºä¸‰ç»„æ•°æ®
    # æç¤ºï¼šæ¨¡æ‹Ÿä¸åŒå¤„ç†æ¡ä»¶çš„åŸºå› è¡¨è¾¾
    # group1 = np.random.normal(100, 20, 50)  # å¯¹ç…§ç»„
    # group2 = ?  # å¤„ç†ç»„A
    # group3 = ?  # å¤„ç†ç»„B
    
    # TODO: ç»˜åˆ¶ç®±çº¿å›¾
    # æç¤ºï¼šä½¿ç”¨ plt.boxplot() æˆ– sns.boxplot()
    
    # TODO: è¿›è¡Œtæ£€éªŒ
    # æç¤ºï¼šä½¿ç”¨ scipy.stats.ttest_ind()
    
    # TODO: æ·»åŠ æ˜¾è‘—æ€§æ ‡è®°
    # æç¤ºï¼šåœ¨æ˜¾è‘—å·®å¼‚çš„ç»„ä¹‹é—´ç”»çº¿å¹¶æ ‡è®° * æˆ– **
    
    pass


def practice_3_professional_volcano():
    """
    ç»ƒä¹ 3ï¼ˆâ˜…â˜…ï¼‰ï¼šåˆ¶ä½œä¸“ä¸šçš„ç«å±±å›¾
    
    ä»»åŠ¡ï¼š
    1. ç”Ÿæˆå·®å¼‚è¡¨è¾¾åˆ†ææ•°æ®ï¼ˆlog2FC å’Œ p-valueï¼‰
    2. åˆ›å»ºç«å±±å›¾ï¼Œä½¿ç”¨è‰²ç›²å‹å¥½é…è‰²
    3. æ·»åŠ é˜ˆå€¼çº¿ï¼ˆFC = Â±1.5, p = 0.05ï¼‰
    4. æ ‡æ³¨æœ€æ˜¾è‘—çš„å‰10ä¸ªåŸºå› 
    5. æ·»åŠ ç»Ÿè®¡ä¿¡æ¯ï¼ˆä¸Šè°ƒ/ä¸‹è°ƒåŸºå› æ•°é‡ï¼‰
    
    ç”Ÿç‰©å­¦èƒŒæ™¯ï¼š
    å±•ç¤ºRNA-seqå·®å¼‚è¡¨è¾¾åˆ†æç»“æœã€‚
    """
    print("\nç»ƒä¹ 3ï¼ˆâ˜…â˜…ï¼‰ï¼šä¸“ä¸šç«å±±å›¾åˆ¶ä½œ")
    print("-" * 40)
    
    # TODO: ç”Ÿæˆå·®å¼‚è¡¨è¾¾æ•°æ®
    # æç¤ºï¼šåˆ›å»ºåŒ…å« log2FC å’Œ p-value çš„æ•°æ®
    # n_genes = 1000
    # log2_fc = np.random.normal(0, 1, n_genes)
    # p_values = ?
    
    # TODO: åˆ†ç±»åŸºå› ï¼ˆä¸Šè°ƒ/ä¸‹è°ƒ/æ— å˜åŒ–ï¼‰
    # æç¤ºï¼šæ ¹æ®é˜ˆå€¼åˆ¤æ–­åŸºå› çŠ¶æ€
    
    # TODO: åˆ›å»ºç«å±±å›¾
    # æç¤ºï¼šä½¿ç”¨ä¸åŒé¢œè‰²æ ‡è®°ä¸åŒç±»åˆ«çš„åŸºå› 
    
    # TODO: æ·»åŠ é˜ˆå€¼çº¿
    # æç¤ºï¼šä½¿ç”¨ axhline() å’Œ axvline()
    
    # TODO: æ ‡æ³¨é‡è¦åŸºå› 
    # æç¤ºï¼šä½¿ç”¨ annotate() æ ‡æ³¨æœ€æ˜¾è‘—çš„åŸºå› 
    
    pass


def practice_4_clustered_heatmap():
    """
    ç»ƒä¹ 4ï¼ˆâ˜…â˜…ï¼‰ï¼šèšç±»çƒ­å›¾åˆ¶ä½œ
    
    ä»»åŠ¡ï¼š
    1. åˆ›å»ºåŸºå› è¡¨è¾¾çŸ©é˜µï¼ˆ20ä¸ªåŸºå›  Ã— 8ä¸ªæ ·æœ¬ï¼‰
    2. è¿›è¡ŒZ-scoreæ ‡å‡†åŒ–
    3. åˆ›å»ºèšç±»çƒ­å›¾
    4. æ·»åŠ æ ·æœ¬åˆ†ç»„æ³¨é‡Šæ¡
    5. ä½¿ç”¨é€‚åˆçš„é…è‰²ï¼ˆçº¢è“æ¸å˜ï¼‰
    
    ç”Ÿç‰©å­¦èƒŒæ™¯ï¼š
    å±•ç¤ºä¸åŒæ ·æœ¬é—´çš„åŸºå› è¡¨è¾¾æ¨¡å¼å’Œèšç±»å…³ç³»ã€‚
    """
    print("\nç»ƒä¹ 4ï¼ˆâ˜…â˜…ï¼‰ï¼šèšç±»çƒ­å›¾åˆ¶ä½œ")
    print("-" * 40)
    
    # TODO: åˆ›å»ºè¡¨è¾¾çŸ©é˜µ
    # æç¤ºï¼šåˆ›å»ºæœ‰æ˜æ˜¾æ¨¡å¼çš„æ•°æ®
    # éƒ¨åˆ†åŸºå› åœ¨å¤„ç†ç»„ä¸Šè°ƒï¼Œéƒ¨åˆ†ä¸‹è°ƒ
    
    # TODO: Z-scoreæ ‡å‡†åŒ–
    # æç¤ºï¼š(x - mean) / stdï¼ŒæŒ‰è¡Œæ ‡å‡†åŒ–
    
    # TODO: åˆ›å»ºèšç±»çƒ­å›¾
    # æç¤ºï¼šä½¿ç”¨ sns.clustermap()
    
    # TODO: æ·»åŠ æ ·æœ¬æ³¨é‡Š
    # æç¤ºï¼šä½¿ç”¨ col_colors å‚æ•°
    
    pass


def practice_5_multi_panel_figure():
    """
    ç»ƒä¹ 5ï¼ˆâ˜…â˜…â˜…ï¼‰ï¼šåˆ›å»ºå‘è¡¨çº§åˆ«çš„å¤šé¢æ¿å›¾
    
    ä»»åŠ¡ï¼š
    åˆ›å»ºä¸€ä¸ªåŒ…å«6ä¸ªå­å›¾çš„Figureï¼Œå±•ç¤ºå®Œæ•´çš„åŸºå› è¡¨è¾¾åˆ†æï¼š
    A. æ ·æœ¬è´¨é‡æ§åˆ¶ï¼ˆç®±çº¿å›¾ï¼‰
    B. ä¸»æˆåˆ†åˆ†æï¼ˆPCAæ•£ç‚¹å›¾ï¼‰
    C. å·®å¼‚è¡¨è¾¾ç«å±±å›¾
    D. è¡¨è¾¾çƒ­å›¾
    E. GOå¯Œé›†åˆ†æï¼ˆæŸ±çŠ¶å›¾ï¼‰
    F. KEGGé€šè·¯åˆ†æï¼ˆç‚¹å›¾ï¼‰
    
    è¦æ±‚ï¼š
    - ç»Ÿä¸€çš„é…è‰²æ–¹æ¡ˆ
    - æ¸…æ™°çš„å­å›¾æ ‡å·ï¼ˆA-Fï¼‰
    - é€‚å½“çš„å›¾ä¾‹å’Œæ ‡ç­¾
    - å‘è¡¨çº§åˆ«çš„è´¨é‡
    
    ç”Ÿç‰©å­¦èƒŒæ™¯ï¼š
    å®Œæ•´å±•ç¤ºä¸€ä¸ªRNA-seqæ•°æ®åˆ†æçš„ä¸»è¦ç»“æœã€‚
    """
    print("\nç»ƒä¹ 5ï¼ˆâ˜…â˜…â˜…ï¼‰ï¼šå¤šé¢æ¿ç»„åˆå›¾")
    print("-" * 40)
    
    # TODO: åˆ›å»º 2Ã—3 çš„å­å›¾å¸ƒå±€
    # æç¤ºï¼šä½¿ç”¨ plt.subplots() æˆ– gridspec
    
    # TODO: å­å›¾A - æ ·æœ¬è´¨é‡æ§åˆ¶
    # ç»˜åˆ¶å„æ ·æœ¬çš„è¡¨è¾¾é‡åˆ†å¸ƒç®±çº¿å›¾
    
    # TODO: å­å›¾B - PCAåˆ†æ
    # ç»˜åˆ¶æ ·æœ¬çš„PCAæ•£ç‚¹å›¾
    
    # TODO: å­å›¾C - ç«å±±å›¾
    # å±•ç¤ºå·®å¼‚è¡¨è¾¾åˆ†æç»“æœ
    
    # TODO: å­å›¾D - çƒ­å›¾
    # å±•ç¤ºtopå·®å¼‚åŸºå› çš„è¡¨è¾¾æ¨¡å¼
    
    # TODO: å­å›¾E - GOå¯Œé›†
    # æŸ±çŠ¶å›¾å±•ç¤ºå¯Œé›†çš„ç”Ÿç‰©è¿‡ç¨‹
    
    # TODO: å­å›¾F - KEGGé€šè·¯
    # ç‚¹å›¾å±•ç¤ºå¯Œé›†çš„ä¿¡å·é€šè·¯
    
    pass


def practice_6_interactive_plot():
    """
    ç»ƒä¹ 6ï¼ˆâ˜…â˜…â˜…ï¼‰ï¼šåˆ›å»ºäº¤äº’å¼å›¾è¡¨
    
    ä»»åŠ¡ï¼š
    1. ä½¿ç”¨plotlyåˆ›å»ºäº¤äº’å¼æ•£ç‚¹å›¾
    2. æ‚¬åœæ˜¾ç¤ºåŸºå› åç§°å’Œè¡¨è¾¾å€¼
    3. æ”¯æŒç¼©æ”¾å’Œå¹³ç§»
    4. æ·»åŠ é€‰æ‹©å·¥å…·
    
    ç”Ÿç‰©å­¦èƒŒæ™¯ï¼š
    æ¢ç´¢æ€§æ•°æ®åˆ†æï¼Œå¿«é€ŸæŸ¥çœ‹æ„Ÿå…´è¶£çš„åŸºå› ã€‚
    """
    print("\nç»ƒä¹ 6ï¼ˆâ˜…â˜…â˜…ï¼‰ï¼šäº¤äº’å¼å›¾è¡¨")
    print("-" * 40)
    
    # TODO: å®‰è£…plotlyï¼ˆå¦‚æœæœªå®‰è£…ï¼‰
    # pip install plotly
    
    # TODO: åˆ›å»ºäº¤äº’å¼æ•£ç‚¹å›¾
    # æç¤ºï¼šä½¿ç”¨ plotly.express.scatter()
    
    # TODO: æ·»åŠ æ‚¬åœä¿¡æ¯
    # æç¤ºï¼šè®¾ç½® hover_data å‚æ•°
    
    # TODO: è‡ªå®šä¹‰æ ·å¼
    # æç¤ºï¼šè®¾ç½®ä¸»é¢˜ã€é¢œè‰²ç­‰
    
    pass


def bonus_publication_checklist():
    """
    é™„åŠ å†…å®¹ï¼šå‘è¡¨çº§åˆ«å›¾è¡¨æ£€æŸ¥æ¸…å•
    
    åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œè‡ªåŠ¨æ£€æŸ¥å›¾è¡¨æ˜¯å¦ç¬¦åˆå‘è¡¨è¦æ±‚ã€‚
    """
    print("\nğŸ“‹ å‘è¡¨çº§åˆ«å›¾è¡¨æ£€æŸ¥æ¸…å•")
    print("-" * 40)
    
    checklist = {
        "å­—ä½“å¤§å° >= 8pt": False,
        "çº¿æ¡å®½åº¦ >= 1pt": False,
        "åˆ†è¾¨ç‡ >= 300 DPI": False,
        "åŒ…å«åæ ‡è½´æ ‡ç­¾": False,
        "åŒ…å«å•ä½": False,
        "è‰²ç›²å‹å¥½é…è‰²": False,
        "åŒ…å«å›¾ä¾‹": False,
        "åŒ…å«ç»Ÿè®¡ä¿¡æ¯": False,
        "æ— 3Dæ•ˆæœ": True,
        "æ— è¿‡åº¦è£…é¥°": True
    }
    
    # TODO: å®ç°è‡ªåŠ¨æ£€æŸ¥åŠŸèƒ½
    # æç¤ºï¼šæ£€æŸ¥ matplotlib çš„å½“å‰è®¾ç½®
    
    print("\næ£€æŸ¥ç»“æœï¼š")
    for item, status in checklist.items():
        symbol = "âœ“" if status else "âœ—"
        print(f"  {symbol} {item}")
    
    # è®¡ç®—ç¬¦åˆåº¦
    compliance = sum(checklist.values()) / len(checklist) * 100
    print(f"\nç¬¦åˆåº¦ï¼š{compliance:.1f}%")
    
    if compliance >= 80:
        print("çŠ¶æ€ï¼šå¯ä»¥æŠ•ç¨¿ âœ¨")
    elif compliance >= 60:
        print("çŠ¶æ€ï¼šéœ€è¦æ”¹è¿› âš ï¸")
    else:
        print("çŠ¶æ€ï¼šéœ€è¦å¤§å¹…ä¿®æ”¹ âŒ")


def main():
    """
    ä¸»å‡½æ•°ï¼šè¿è¡Œæ‰€æœ‰ç»ƒä¹ 
    """
    print("=" * 60)
    print("Chapter 08: æ•°æ®å¯è§†åŒ– - ç»ƒä¹ é¢˜")
    print("=" * 60)
    print("\nç›®æ ‡ï¼šæŒæ¡ä»åŸºç¡€åˆ°å‘è¡¨çº§åˆ«çš„ç§‘ç ”å›¾è¡¨åˆ¶ä½œ")
    print("\næç¤ºï¼š")
    print("1. å…ˆå®ŒæˆåŸºç¡€ç»ƒä¹ ï¼ŒæŒæ¡åŸºæœ¬æŠ€èƒ½")
    print("2. è¿›é˜¶ç»ƒä¹ æ³¨é‡ä¸“ä¸šæ€§å’Œç¾è§‚æ€§")
    print("3. æŒ‘æˆ˜ç»ƒä¹ æ¨¡æ‹ŸçœŸå®çš„ç§‘ç ”åœºæ™¯")
    print("\n" + "=" * 60 + "\n")
    
    # åŸºç¡€ç»ƒä¹ 
    practice_1_basic_scatter()
    practice_2_boxplot_with_significance()
    
    # è¿›é˜¶ç»ƒä¹ 
    practice_3_professional_volcano()
    practice_4_clustered_heatmap()
    
    # æŒ‘æˆ˜ç»ƒä¹ 
    practice_5_multi_panel_figure()
    practice_6_interactive_plot()
    
    # é™„åŠ å†…å®¹
    bonus_publication_checklist()
    
    print("\n" + "=" * 60)
    print("ğŸ’¡ ç»ƒä¹ å»ºè®®ï¼š")
    print("1. ä»ç®€å•çš„å›¾è¡¨å¼€å§‹ï¼Œé€æ­¥å¢åŠ å¤æ‚åº¦")
    print("2. æ³¨æ„æ¯ä¸ªç»†èŠ‚ï¼ŒåŒ…æ‹¬å­—ä½“ã€é¢œè‰²ã€æ ‡ç­¾")
    print("3. å‚è€ƒé«˜å½±å“å› å­æœŸåˆŠçš„å›¾è¡¨é£æ ¼")
    print("4. ä¿å­˜ä¸åŒç‰ˆæœ¬ï¼Œå¯¹æ¯”æ”¹è¿›æ•ˆæœ")
    print("5. è¯·åŒè¡Œè¯„å®¡ä½ çš„å›¾è¡¨")


if __name__ == "__main__":
    main()